#!/bin/bash
# Пример deploy hook скрипта для Certbot
# Этот файл показывает, как настроить автоматическое обновление сертификатов
# 
# Инструкция по установке:
# 1. Скопируйте этот файл в /etc/letsencrypt/renewal-hooks/deploy/volleybot-update.sh
# 2. Замените YOUR_DOMAIN и /path/to/volleybot на ваши реальные значения
# 3. Сделайте файл исполняемым: sudo chmod +x /etc/letsencrypt/renewal-hooks/deploy/volleybot-update.sh
#
# Certbot автоматически вызовет этот скрипт после успешного обновления сертификатов

# ============================================
# НАСТРОЙКИ - ЗАМЕНИТЕ НА ВАШИ ЗНАЧЕНИЯ
# ============================================
DOMAIN="YOUR_DOMAIN"                    # Ваш домен (например: example.com)
PROJECT_PATH="/path/to/volleybot"       # Полный путь к проекту volleybot
UPDATE_SCRIPT="${PROJECT_PATH}/update_certs.sh"

# ============================================
# ПРОВЕРКА ПАРАМЕТРОВ
# ============================================
if [ "$DOMAIN" = "YOUR_DOMAIN" ] || [ "$PROJECT_PATH" = "/path/to/volleybot" ]; then
    echo "Ошибка: Замените YOUR_DOMAIN и /path/to/volleybot на реальные значения в скрипте!"
    exit 1
fi

# ============================================
# ВЫПОЛНЕНИЕ ОБНОВЛЕНИЯ
# ============================================
if [ -f "$UPDATE_SCRIPT" ]; then
    echo "Обновление сертификатов для $DOMAIN..."
    "$UPDATE_SCRIPT" "$DOMAIN" "$PROJECT_PATH"
    
    if [ $? -eq 0 ]; then
        echo "✓ Сертификаты успешно обновлены для volleybot"
    else
        echo "✗ Ошибка при обновлении сертификатов"
        exit 1
    fi
else
    echo "Ошибка: Скрипт обновления не найден: $UPDATE_SCRIPT"
    exit 1
fi

# ============================================
# ДОПОЛНИТЕЛЬНЫЕ ДЕЙСТВИЯ (опционально)
# ============================================
# Если вы используете Nginx, раскомментируйте следующую строку:
# sudo systemctl reload nginx

# Если вы используете другой веб-сервер, добавьте команду перезагрузки здесь




