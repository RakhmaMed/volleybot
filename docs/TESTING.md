# üß™ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é VolleyBot

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–æ—Ç–µ –±–µ–∑ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–µ.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ë–î](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–±–µ–∑-–∏–∑–º–µ–Ω–µ–Ω–∏—è-–±–¥)
- [–ü–æ–ª—É—á–µ–Ω–∏–µ ID —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —á–∞—Ç–∞](#–ø–æ–ª—É—á–µ–Ω–∏–µ-id-—Ç–µ—Å—Ç–æ–≤–æ–≥–æ-—á–∞—Ç–∞)
- [–¢–∏–ø–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#—Ç–∏–ø–æ–≤—ã–µ-—Å—Ü–µ–Ω–∞—Ä–∏–∏-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-—Ç–µ—Å—Ç—ã)
- [–û—Ç–ª–∞–¥–∫–∞](#–æ—Ç–ª–∞–¥–∫–∞)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–± ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `test_bot.py`:

```bash
python test_bot.py
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è –ë–î –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–π –æ–ø—Ä–æ—Å
- ‚úÖ –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –ª—é–±–æ–º —á–∞—Ç–µ
- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π .env

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –°–æ–∑–¥–∞–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è –ë–î –≤ –ø–∞–º—è—Ç–∏
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–π –æ–ø—Ä–æ—Å (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã)
3. –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ polling
4. –ü–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (Ctrl+C) –≤—Ä–µ–º–µ–Ω–Ω–∞—è –ë–î —É–¥–∞–ª—è–µ—Ç—Å—è

### –í–∞—Ä–∏–∞–Ω—Ç 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –æ—Ç–¥–µ–ª—å–Ω–æ–π –ë–î

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏:

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ø–∏—é .env –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
cp .env .env.test
```

2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env.test`:
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¢–ï–°–¢–û–í–´–ô —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (—Å–æ–∑–¥–∞–π—Ç–µ —á–µ—Ä–µ–∑ @BotFather)
TELEGRAM_TOKEN=your_test_bot_token

# ID —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —á–∞—Ç–∞
CHAT_ID=your_test_chat_id

# –ü—É—Ç—å –∫ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
DATABASE_PATH=data/test_bot.db
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ —Å —Ç–µ—Å—Ç–æ–≤—ã–º –∫–æ–Ω—Ñ–∏–≥–æ–º:
```bash
ENV_FILE=.env.test python -m src.bot
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ë–î

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ test_bot.py

–°–∫—Ä–∏–ø—Ç `test_bot.py` ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –∑–∞–ø—É—Å–∫–∞, –∫–æ—Ç–æ—Ä—ã–π:

```python
# –°–æ–∑–¥–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î
temp_db_path = tempfile.NamedTemporaryFile(suffix=".db", delete=False)

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –æ–ø—Ä–æ—Å
# –û–ø—Ä–æ—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã, –∏–≥—Ä–∞ —á–µ—Ä–µ–∑ 1 —á–∞—Å
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ:**
```
/start          - –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∫—É
/stop           - –í—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∫—É
/list           - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ–ø—Ä–æ—Å—ã
/open 1         - –û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –æ–ø—Ä–æ—Å –≤—Ä—É—á–Ω—É—é
/close 1        - –ó–∞–∫—Ä—ã—Ç—å –æ–ø—Ä–æ—Å
/results 1      - –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞
/players        - –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
/pay            - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–º
/balance        - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–π –±–∞–ª–∞–Ω—Å
```

**–ü—Ä–∏–º–µ—Ä —Å–µ—Å—Å–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

```bash
$ python test_bot.py
üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
üìÅ –í—Ä–µ–º–µ–Ω–Ω–∞—è –ë–î: /tmp/test_volleybot_xyz123.db
‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –æ–ø—Ä–æ—Å —Å–æ–∑–¥–∞–Ω (ID: 1)
   üìÖ –û—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ 14:25, –∏–≥—Ä–∞ –≤ 15:23

üöÄ –ë–û–¢ –ó–ê–ü–£–©–ï–ù –í –¢–ï–°–¢–û–í–û–ú –†–ï–ñ–ò–ú–ï
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
   /start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
   /open 1 - –û—Ç–∫—Ä—ã—Ç—å –æ–ø—Ä–æ—Å –≤—Ä—É—á–Ω—É—é
   ...

üí° –°–æ–≤–µ—Ç—ã:
   - –ú–æ–∂–µ—Ç–µ –ø–∏—Å–∞—Ç—å –±–æ—Ç—É –∏–∑ –ª—é–±–æ–≥–æ —á–∞—Ç–∞
   - –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ
   - –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

–í—ã –º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞ –ø—Ä—è–º–æ –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python test_bot.py`
2. –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã `/open 1`, `/pay` –∏ —Ç.–¥.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥—Ä—É–ø–ø–æ–≤—ã–µ –æ–ø—Ä–æ—Å—ã) —Ç—Ä–µ–±—É—é—Ç –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç.

## –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —á–∞—Ç–∞

–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–∞–º –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —É–∑–Ω–∞—Ç—å ID —á–∞—Ç–∞.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Ç–∏–ª–∏—Ç—ã get_chat_id.py

```bash
python get_chat_id.py
```

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:**

1. –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å—Ç–∏—Ç –±–æ—Ç–∞ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
   - –í –ª–∏—á–∫—É ‚Äî –ø–æ–ª—É—á–∏—Ç–µ —Å–≤–æ–π User ID
   - –í –≥—Ä—É–ø–ø–µ ‚Äî –ø–æ–ª—É—á–∏—Ç–µ Chat ID –≥—Ä—É–ø–ø—ã
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ .env

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**

```
üìä –ü–û–õ–£–ß–ï–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ß–ê–¢–ï
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–¢–∏–ø —á–∞—Ç–∞: supergroup
Chat ID: -1001234567890
–ù–∞–∑–≤–∞–Ω–∏–µ: –¢–µ—Å—Ç–æ–≤–∞—è –≥—Ä—É–ø–ø–∞ –≤–æ–ª–µ–π–±–æ–ª

–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å:
  User ID: 123456789
  Username: @your_username
  –ò–º—è: –í–∞—à–µ –ò–º—è
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üíæ –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ .env –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
   CHAT_ID=-1001234567890
   ADMIN_USER_ID=123456789
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç)

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –∑–∞–ø—É—â–µ–Ω –±–æ—Ç —Å –∞–¥–º–∏–Ω—Å–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏:

1. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ —Ç–µ—Å—Ç–æ–≤—É—é –≥—Ä—É–ø–ø—É
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/chatid` (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
3. –ë–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç —Å ID —á–∞—Ç–∞

## –¢–∏–ø–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç
python test_bot.py

# 2. –í Telegram –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É
/start

# 3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –æ–ø—Ä–æ—Å
/open 1

# 4. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
# –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–∂–∏–º–∞–π—Ç–µ inline-–∫–Ω–æ–ø–∫–∏, –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ—Ç–≤–µ—Ç—ã

# 5. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞
Ctrl+C
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

–î–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏:

1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –≥—Ä—É–ø–ø—É –≤ Telegram
2. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É
3. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–∑–µ–π –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python test_bot.py`
5. –ü–æ–ª—É—á–∏—Ç–µ Chat ID –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ `/chatid` –∏–ª–∏ `python get_chat_id.py`
6. –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –º–æ–≥—É—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–æ—Ç–æ–º

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

–ß—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –æ–ø—Ä–æ—Å–æ–≤:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ test_bot.py
python test_bot.py

# –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç –æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã

# 2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 2 –º–∏–Ω—É—Ç—ã –∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤—Ä—É—á–Ω—É—é
/open 1

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –æ–ø—Ä–æ—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –æ–ø–ª–∞—Ç—ã

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç
python test_bot.py

# 2. –í Telegram –æ—Ç–ø—Ä–∞–≤—å—Ç–µ
/pay

# 3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
#    - –í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
#    - –ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞
#    - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å
/balance
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ callback –∫–Ω–æ–ø–æ–∫

–ï—Å–ª–∏ inline-–∫–Ω–æ–ø–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:

```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ allowed_updates
python test_bot.py

# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# üìã –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã updates: message, callback_query, poll_answer

# 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏
/pay

# 3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É

# 4. –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è
# Incoming update: callback_query

# –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç pytest –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
./manage.sh test
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ pytest:

```bash
pytest tests/ -v
```

### –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞

```bash
pytest tests/ --cov=src --cov-report=html
```

–û—Ç—á–µ—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ `htmlcov/index.html`.

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞

```bash
# –û–¥–∏–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
pytest tests/test_handlers.py -v

# –û–¥–∏–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª–∞—Å—Å
pytest tests/test_handlers.py::TestHandlers -v

# –û–¥–Ω–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
pytest tests/test_handlers.py::TestHandlers::test_start_handler -v
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ conftest.py              # –û–±—â–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ test_config.py           # –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ test_db.py               # –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ test_handlers.py         # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ test_poll.py             # –¢–µ—Å—Ç—ã –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ test_scheduler.py        # –¢–µ—Å—Ç—ã –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
‚îî‚îÄ‚îÄ test_services/
    ‚îú‚îÄ‚îÄ test_admin_service.py
    ‚îú‚îÄ‚îÄ test_bot_state_service.py
    ‚îî‚îÄ‚îÄ test_poll_service.py
```

## –û—Ç–ª–∞–¥–∫–∞

### –í–∫–ª—é—á–µ–Ω–∏–µ DEBUG –ª–æ–≥–æ–≤

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:

1. –í `.env` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```bash
LOG_LEVEL=DEBUG
```

2. –ò–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –∫–æ–¥–µ `test_bot.py`:
```python
logging.basicConfig(
    level=logging.DEBUG,  # –ë—ã–ª–æ: INFO
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
)
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ webhook

–ï—Å–ª–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç–µ webhook —Ä–µ–∂–∏–º:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å webhook
/webhookinfo

# –í –æ—Ç–≤–µ—Ç–µ –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
# - URL webhook
# - –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã updates
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
# - –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
```

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### –ü—Ä–æ–±–ª–µ–º–∞: inline-–∫–Ω–æ–ø–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ callback_query –≤ allowed_updates
/webhookinfo

# 2. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ webhook, –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ callback_query
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "Incoming update: callback_query"
```

#### –ü—Ä–æ–±–ª–µ–º–∞: –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –≤ –≥—Ä—É–ø–ø–µ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –∞–¥–º–∏–Ω –≥—Ä—É–ø–ø—ã
# –ò–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ Privacy Mode –≤ @BotFather

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CHAT_ID –≤ .env
python get_chat_id.py

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –ª–æ–≥–∞—Ö
# –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∞–≤–∞–º–∏ –±–æ—Ç–∞
```

#### –ü—Ä–æ–±–ª–µ–º–∞: –æ–ø—Ä–æ—Å—ã –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—â–µ–Ω
# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—â–µ–Ω"

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤ –ë–î
/schedule

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É
# –í .env: SCHEDULER_TIMEZONE=Europe/Moscow
```

#### –ü—Ä–æ–±–ª–µ–º–∞: –ë–î –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–∞—è –ë–î –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º:

# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã –±–æ—Ç–∞
pkill -f "python.*bot.py"

# 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ test_bot.py ‚Äî –æ–Ω —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é –ë–î
python test_bot.py
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ DO

- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `test_bot.py`** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ —Ä–∏—Å–∫–∞
- **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã** –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
- **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π .env.test** –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã** –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏** –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –ø—Ä–æ–±–ª–µ–º
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ DEBUG —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### ‚ùå DON'T

- **–ù–µ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –±–æ—Ç–µ** –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- **–ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ .env —Ñ–∞–π–ª—ã** –≤ git
- **–ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã** –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ë–î** –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
- **–ù–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö** ‚Äî –æ–Ω–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../README.md)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](CONFIGURATION.md)
- [Troubleshooting](../README.md#-—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)
- [aiogram –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.aiogram.dev/)

## –í–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ .env —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Å `test_bot.py`
4. –ò–∑—É—á–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ —Ä–∞–∑–¥–µ–ª–µ [–¢–∏–ø–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏](#—Ç–∏–ø–æ–≤—ã–µ-—Å—Ü–µ–Ω–∞—Ä–∏–∏-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)